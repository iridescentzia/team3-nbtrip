import{H as X}from"./Header-farsS_65.js";import{_ as D,f as _,g as c,h as e,j as Y,e as b,r as f,m as y,t as k,u as m,F as S,q as V,H as w,d as tt,o as R,l as M,D as L,L as T,Q as et,T as F,i as O,A as at,C as st,s as rt,a as nt,y as ot,k as $,n as lt}from"./index-9_HCdh5a.js";import{c as I}from"./createLucideIcon-CAS1lwv-.js";import{t as z}from"./tripApi-43bVndV-.js";import{m as it}from"./memberApi-DtniH5jf.js";import{B as P}from"./Button-DjkXC8M-.js";import{C as N}from"./chevron-down-CYDtMPN-.js";const ct={},dt={class:"view-wrapper"},ut={class:"mobile-view"};function pt(o,a){return c(),_("div",dt,[e("div",ut,[Y(o.$slots,"default",{},void 0,!0)])])}const mt=D(ct,[["render",pt],["__scopeId","data-v-e4e591ce"]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=I("file-chart-column",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-1",key:"zg0ygc"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"M16 18v-3",key:"j5jt4h"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=I("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=I("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=I("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),gt={class:"travel-card"},ht={class:"card-header"},bt={class:"title-date"},kt={class:"title-row"},Ct={class:"trip-name"},Dt={class:"trip-date"},$t={class:"tab-list"},wt=["onClick"],Mt={__name:"TravelCard",props:{tripName:String,startDate:String,endDate:String},setup(o){const a=o,u=b(()=>{const t=a.startDate?.replaceAll("-",".")??"",s=a.endDate?.replaceAll("-",".")??"";return t&&s?`${t} ~ ${s}`:""}),d=["그룹 지출 내역","선결제 내역","그룹 관리"],p=f(d[0]);function l(t){p.value=t}function v(){router.push({name:"chart",params:{tripId:1}})}return(t,s)=>(c(),_("div",gt,[e("div",ht,[e("div",bt,[e("div",kt,[e("div",Ct,k(a.tripName),1),y(m(vt),{class:"icon",onClick:v})]),e("div",Dt,k(u.value),1)]),y(m(_t),{class:"icon trash-icon"})]),s[0]||(s[0]=e("div",{class:"divider"},null,-1)),e("div",$t,[(c(),_(S,null,V(d,r=>e("div",{key:r,class:w(["tab-item",{active:p.value===r}]),onClick:i=>l(r)},k(r),11,wt)),64))])]))}},Tt=D(Mt,[["__scopeId","data-v-e3c500b1"]]),E=tt("trip",()=>{const o=f([]),a=async()=>{const t=await z.fetchTrips();o.value=Array.isArray(t)?t:[]},u=b(()=>{const t=Date.now();return o.value.find(s=>s.tripStatus==="ACTIVE"&&t>=s.startDate&&t<=s.endDate)}),d=f([]),p=async()=>{if(u.value)try{const t=await z.getTripDetail(u.value.tripId);console.log(t),d.value=Array.isArray(t.members)?t.members:[]}catch(t){console.error("Failed to fetch current trip members:",t),d.value=[]}},l=f([]);return{trips:o,fetchTrips:a,currentTrip:u,fetchCurrentTripMembers:p,currentTripMembers:d,fetchCurrentTripMemberNicknames:async()=>{l.value=[];const s=d.value.map(r=>r.userId).map(async r=>{try{const i=await it.get(r);return{userId:r,nickname:i.nickname}}catch(i){return console.error(`Failed to fetch user ${r}:`,i),{userId:r,nickname:null}}});l.value=await Promise.all(s)},currentTripMemberNicknames:l}}),St={class:"filter-row"},It={class:"filter-row"},xt={class:"filter-row"},At={class:"bottom-modal"},Lt={class:"bottom-modal"},Ft={class:"bottom-modal"},Pt={class:"member-list"},Nt=["value"],Vt={__name:"Filter",props:{startDate:{type:String,default:""}},emits:["date-filtered"],setup(o,{emit:a}){const u=o,d=a,p=E(),l=f([]),v=new Date,t=f([u.startDate,v]),s=f(!1),r=f(!1),i=f(!1),C=f(!1);f({start:"",end:""}),f(null),f([]);const x=b(()=>r.value&&(t.value[0]!==null||t.value[1]!==null)),U=()=>{s.value=!s.value},H=()=>{s.value=!1},B=g=>new Date(g).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:"Asia/Seoul"}).replace(/\.\s?/g,"-").replace(/-$/,""),Z=()=>{r.value=!0;const[g,n]=t.value,h=g?B(g):"",A=n?B(n):"";d("date-filtered",{start:h,end:A}),H()},K=()=>{console.log("click resetFilter"),r.value=!1,t.value=[u.startDate,v],console.log("reset date: ",t.value[0],t.value[1]),d("date-filtered",{start:"",end:""})},Q=async()=>{C.value=!C.value},q=()=>{C.value=!1},G=()=>{q()},J=async()=>{i.value=!i.value},j=()=>{i.value=!1},W=()=>{j()};return R(async()=>{await p.fetchTrips(),await p.fetchCurrentTripMembers(),await p.fetchCurrentTripMemberNicknames()}),(g,n)=>(c(),_(S,null,[e("div",{class:"filter-bar",onClick:K},[y(m(ft),{class:"reset-icon"}),e("button",{class:w(["filter-button",{active:s.value||x.value}]),onClick:U},[e("div",St,[n[3]||(n[3]=e("div",{class:"filter-text"},"날짜",-1)),y(m(N),{class:"down-icon"})])],2),e("button",{class:w(["filter-button",{active:C.value||g.isCategoryFiltered}]),onClick:Q},[e("div",It,[n[4]||(n[4]=e("div",{class:"filter-text"},"카테고리",-1)),y(m(N),{class:"down-icon"})])],2),e("button",{class:w(["filter-button",{active:i.value||g.isParticipantsFiltered}]),onClick:J},[e("div",xt,[n[5]||(n[5]=e("div",{class:"filter-text"},"결제 참여자",-1)),y(m(N),{class:"down-icon"})])],2)]),s.value?(c(),_("div",{key:0,class:"overlay",onClick:L(H,["self"])},[y(F,{name:"slide-up",appear:""},{default:T(()=>[e("div",At,[n[6]||(n[6]=e("h3",{class:"modal-title"},"날짜 선택",-1)),y(m(et),{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=h=>t.value=h),range:!0,format:"yyyy-MM-dd",clearable:!0,class:"date-picker"},null,8,["modelValue"]),y(P,{onClick:Z,label:"조회하기"})])]),_:1})])):M("",!0),C.value?(c(),_("div",{key:1,class:"overlay",onClick:L(q,["self"])},[y(F,{name:"slide-up",appear:""},{default:T(()=>[e("div",Lt,[n[8]||(n[8]=e("h3",{class:"modal-title"},"카테고리",-1)),O(e("select",{"onUpdate:modelValue":n[1]||(n[1]=h=>g.selectedCategory=h)},n[7]||(n[7]=[e("option",{disabled:"",value:""},"카테고리 선택",-1),e("option",{value:"식비"},"식비",-1),e("option",{value:"교통"},"교통",-1),e("option",{value:"숙박"},"숙박",-1),e("option",{value:"관광"},"관광",-1),e("option",{value:"기타"},"기타",-1)]),512),[[at,g.selectedCategory]]),y(P,{onClick:G,label:"조회하기"})])]),_:1})])):M("",!0),i.value?(c(),_("div",{key:2,class:"overlay",onClick:L(j,["self"])},[y(F,{name:"slide-up",appear:""},{default:T(()=>[e("div",Ft,[n[9]||(n[9]=e("h3",{class:"modal-title"},"결제 참여자",-1)),e("div",Pt,[(c(!0),_(S,null,V(m(p).currentTripMemberNicknames,h=>(c(),_("label",{key:h.userId,class:"member-item"},[O(e("input",{type:"checkbox","onUpdate:modelValue":n[2]||(n[2]=A=>l.value=A),value:h.userId},null,8,Nt),[[rt,l.value]]),st(" "+k(h.nickname),1)]))),128))]),y(P,{onClick:W,label:"조회하기"})])]),_:1})])):M("",!0)],64))}},Rt=D(Vt,[["__scopeId","data-v-0ff06545"]]),Ht={class:"expense-card"},Bt={class:"left"},qt={class:"title"},jt={class:"sub"},Ot={class:"right"},zt={__name:"PaymentListInfoCard",props:{title:String,sub:String,amount:Number},setup(o){return(a,u)=>(c(),_("div",Ht,[e("div",Bt,[e("div",qt,k(o.title),1),e("div",jt,k(o.sub),1)]),e("div",Ot,k(o.amount.toLocaleString())+"원",1)]))}},Et=D(zt,[["__scopeId","data-v-cc7df73f"]]),Ut={async getPaymentList(o){const{data:a}=await nt.get(`/paymentlist/${o}`);return console.log("payment data: ",a),a}},Zt={class:"wrapper"},Kt={__name:"PaymentListInfo",props:{dateRange:{type:Object,default:()=>({start:"",end:""})}},setup(o){const a=o,u=ot(),d=Number(u.params.tripId),p=f([]),l=b(()=>{const{start:t,end:s}=a.dateRange;return console.log("[PaymentListInfo.vue] 현재 dateRange:",t,s),!t&&!s?p.value:p.value.filter(r=>{const i=r.payAt.slice(0,10);if(t&&s)return i>=t&&i<=s;if(t)return i>=t;if(s)return i<=s})});function v(t,s){const r=new Date(s),i=r.getHours().toString().padStart(2,"0"),C=r.getMinutes().toString().padStart(2,"0"),x=r.getHours()<12?"오전":"오후";return`${t} · ${x} ${i}:${C}`}return R(async()=>{try{const t=await Ut.getPaymentList(d);console.log("결제내역 리스트",t),console.log("tripId",d),Array.isArray(t.paymentData)?p.value=t.paymentData:console.warn("paymentData가 배열이 아님",t)}catch(t){console.error("결제 내역 불러오기 실패:",t)}}),(t,s)=>(c(),_("div",Zt,[(c(!0),_(S,null,V(l.value,(r,i)=>(c(),$(Et,{key:i,title:r.memo,sub:v(r.userId,r.payAt),amount:r.amount},null,8,["title","sub","amount"]))),128))]))}},Qt=D(Kt,[["__scopeId","data-v-80f811e2"]]),Gt={class:"summary-card"},Jt={class:"amount-row"},Wt={class:"amount"},Xt={class:"progress-bar"},Yt={__name:"Summary",props:{amount:{type:Number,required:!0},budget:{type:Number,required:!0}},setup(o){const a=o,u=b(()=>a.amount.toLocaleString()+"원");b(()=>a.budget.toLocaleString()+"원");const d=b(()=>{const{amount:l,budget:v}=a;if(!v||v===0)return 0;const t=l/v*100;return Math.min(t,100).toFixed(1)}),p=b(()=>a.amount>=a.budget);return(l,v)=>(c(),_("div",Gt,[v[0]||(v[0]=e("div",{class:"summary-header"},[e("span",{class:"label"},"총 사용 금액"),e("button",{class:"terminate",small:""},"여행 종료하기")],-1)),e("div",Jt,[e("div",Wt,k(u.value),1),y(m(yt),{class:"info-icon"})]),e("div",Xt,[e("div",{class:w(["progress",{over:p.value}]),style:lt({width:d.value+"%"})},null,6)])]))}},te=D(Yt,[["__scopeId","data-v-b600063f"]]),ee={class:"content-container"},ae={key:1},se={__name:"PaymentList",setup(o){const a=E(),u=l=>new Date(l).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:"Asia/Seoul"}).replace(/\.\s/g,".").replace(/\.$/,""),d=f({start:"",end:""});function p(l){console.log("[PaymentList.vue] 받은 날짜 범위:",l),d.value=l}return R(async()=>{await a.fetchTrips(),await a.fetchCurrentTripMembers(),console.log("currentTrip:",a.currentTrip)}),(l,v)=>(c(),$(mt,null,{default:T(()=>[y(X,{title:"진행 중인 여행"}),e("div",ee,[m(a).currentTrip?(c(),$(Tt,{key:0,"trip-name":m(a).currentTrip.tripName,"start-date":u(m(a).currentTrip.startDate),"end-date":u(m(a).currentTrip.endDate),showEdit:""},null,8,["trip-name","start-date","end-date"])):(c(),_("div",ae,"현재 진행 중인 여행이 없습니다.")),m(a).currentTrip?(c(),$(te,{key:2,amount:1e6,budget:m(a).currentTrip.budget},null,8,["budget"])):M("",!0),m(a).currentTrip?(c(),$(Rt,{key:3,"start-date":u(m(a).currentTrip.startDate),onDateFiltered:p},null,8,["start-date"])):M("",!0),y(Qt,{"date-range":d.value},null,8,["date-range"])])]),_:1}))}},ue=D(se,[["__scopeId","data-v-a0d82911"]]);export{ue as default};
