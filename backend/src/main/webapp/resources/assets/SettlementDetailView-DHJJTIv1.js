import{_ as C,s as T,a as N,u as R,o as w,c as o,b as n,e as t,g as f,d as M,f as s,t as i,F as u,h,j as v,k as V}from"./index-C9ApI8vq.js";import{H as I}from"./Header2-UY8uQ6hN.js";import{u as L}from"./settlementStore-C9vI0BBV.js";import"./index-PeG32rCn.js";const $={class:"settlement-view"},B={key:0,class:"content-container loading"},D={key:1,class:"content-container error"},A={key:2,class:"content-container"},F={class:"summary-header"},H={class:"trip-name"},j={class:"total-amount"},E={class:"settlement-card"},q={class:"transaction-list"},z={key:0},G={class:"member-info"},J={class:"avatar"},K={class:"font-semibold text-sm text-theme-text"},O={class:"amount text-theme-text"},P={key:1,class:"empty-message text-theme-text"},Q={class:"settlement-card"},U={class:"transaction-list"},W={key:0},X={class:"member-info"},Y={class:"avatar"},Z={class:"font-semibold text-sm"},tt={class:"amount"},et={key:1,class:"empty-message"},st={class:"footer"},ot=["disabled"],nt={__name:"SettlementDetailView",setup(at){const c=L(),{mySettlementData:a,isLoading:k,error:_,showTransferModal:y,totalReceiveAmount:lt,totalSendAmount:b,netBalance:rt}=T(c),g=N(),m=R(),d=g.params.tripId;w(async()=>{try{await c.fetchMySettlement(d)}catch{}});const S=()=>{try{c.openTransferModal()}catch(l){alert(l.message)}},p=()=>{c.closeTransferModal()},x=async()=>{c.closeTransferModal();try{const l=await c.executeTransfer();l.failedCount==0?(alert("모든 송금이 완료되었습니다."),m.push(`/settlement/${d}/pending`)):(alert(`송금 실패: ${l.successCount}건 성공, ${l.failedCount}건 실패`),m.push(`/settlement/${d}/failure`))}catch(l){console.error("송금 실패:",l),alert("송금 중 오류가 발생했습니다."),m.push(`/settlement/${d}/failure`)}};return(l,e)=>(n(),o(u,null,[t("div",$,[M(I,{title:"정산하기"}),s(k)?(n(),o("main",B,e[1]||(e[1]=[t("p",null,"내 정산 내역을 불러오는 중...",-1)]))):s(_)?(n(),o("main",D,[t("p",null,i(s(_)),1)])):s(a)?(n(),o("main",A,[t("div",F,[t("p",H,i(s(a).tripName),1),t("h2",j," 총 "+i(s(a).totalAmount?.toLocaleString()||0)+"원 사용 ",1)]),t("div",E,[e[2]||(e[2]=t("p",{class:"card-title text-theme-text"},"받을 돈",-1)),t("div",q,[s(a).toReceive&&s(a).toReceive.length>0?(n(),o("div",z,[(n(!0),o(u,null,h(s(a).toReceive,r=>(n(),o("div",{key:r.settlementId,class:"transaction-item"},[t("div",G,[t("div",J,[t("span",null,i(r.senderNickname?.substring(0,1)||"?"),1)]),t("span",K,i(r.senderNickname||"알 수 없음"),1)]),t("span",O,i(r.amount?.toLocaleString()||0)+"원 ",1)]))),128))])):(n(),o("p",P," 받을 돈이 없습니다. "))])]),t("div",Q,[e[3]||(e[3]=t("p",{class:"card-title"},"보낼 돈",-1)),t("div",U,[s(a).toSend&&s(a).toSend.length>0?(n(),o("div",W,[(n(!0),o(u,null,h(s(a).toSend,r=>(n(),o("div",{key:r.settlementId,class:"transaction-item"},[t("div",X,[t("div",Y,[t("span",null,i(r.receiverNickname?.substring(0,1)||"?"),1)]),t("span",Z,i(r.receiverNickname||"알 수 없음"),1)]),t("span",tt,i(r.amount?.toLocaleString()||0)+"원",1)]))),128))])):(n(),o("p",et,"보낼 돈이 없습니다."))])])])):f("",!0),t("footer",st,[t("button",{onClick:S,class:"next-button",disabled:s(b)===0}," 송금하기 ",8,ot)])]),s(y)?(n(),o("div",{key:0,class:"modal-overlay",onClick:p},[t("div",{class:"transfer-modal",onClick:e[0]||(e[0]=V(()=>{},["stop"]))},[e[4]||(e[4]=t("div",{class:"modal-icon"},null,-1)),e[5]||(e[5]=t("h3",{class:"modal-title"},"송금하시겠습니까?",-1)),e[6]||(e[6]=t("p",{class:"modal-description"},[v(" 송금 버튼을 누르면 정산이 완료되며,"),t("br"),v(" 되돌릴 수 없습니다. ")],-1)),t("div",{class:"modal-buttons"},[t("button",{onClick:p,class:"modal-cancel-btn"},"취소"),t("button",{onClick:x,class:"modal-confirm-btn"},"확인")])])])):f("",!0)],64))}},ut=C(nt,[["__scopeId","data-v-a20477c7"]]);export{ut as default};
