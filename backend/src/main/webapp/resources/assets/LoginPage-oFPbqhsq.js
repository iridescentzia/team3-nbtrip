import{l as b,_ as w,u as S,r as c,m as T,n as I,c as h,b as p,e as t,w as g,p as f,q as x,t as M,f as L}from"./index-C9ApI8vq.js";import{_ as U}from"./logo-C8BEaK4T.js";import{g as B,l as C,c as F,a as v,s as J}from"./memberApi-B4rY3kMz.js";import N from"./JoinPage-JTDRNpqv.js";import"./index-PeG32rCn.js";import"./Button-Cy-Utsyx.js";import"./Header--lDqDarc.js";import"./createLucideIcon-CLFNeeXC.js";const V=b("auth",{state:()=>({user:null,accessToken:null}),actions:{async login({email:s,password:n,fcmToken:u}){try{const r=await v({email:s,password:n,fcmToken:u}),{accessToken:a,userInfo:o}=r;return this.accessToken=a,this.user=o,J(a),localStorage.setItem("userInfo",JSON.stringify(o)),!0}catch(r){throw console.error("로그인 실패:",r.message),r}},async restoreSession(){const s=localStorage.getItem("accessToken"),n=localStorage.getItem("userInfo");s&&n?(this.accessToken=s,this.user=JSON.parse(n)):(this.accessToken=null,this.user=null)},async logout(){try{await C()}catch(s){console.warn("로그아웃 중 오류:",s.message)}finally{this.accessToken=null,this.user=null,F(),localStorage.removeItem("userInfo")}},async refreshUserInfo(){try{const s=await B();this.user=s,localStorage.setItem("userInfo",JSON.stringify(s))}catch(s){console.error("유저 정보 갱신 실패:",s.message)}},setToken(s){this.accessToken=s},setUser(s){this.user=s}}}),_={key:1,class:"login-content"},O={class:"form-area"},P=["disabled"],D=["disabled"],K=["disabled"],$={class:"signup-section"},q={__name:"LoginPage",setup(s){const n=S(),u=V(),r=c(!1),a=c(!1),o=c({email:"",password:""}),d=T(()=>o.value.email&&o.value.password),k=async()=>{try{return""}catch(i){return console.error("FCM 토큰 오류:",i),""}},m=async()=>{if(!d.value){alert("이메일과 비밀번호를 입력해주세요.");return}try{a.value=!0;const i=await k(),e=await v({email:o.value.email,password:o.value.password,fcmToken:i}),l=e.accessToken||e.token,y=e.user||e.member;localStorage.setItem("accessToken",l),u.setToken(l),u.setUser(y),alert("로그인 성공!"),n.push("/")}catch(i){alert(i.message||"로그인에 실패했습니다."),console.error("로그인 오류:",i)}finally{a.value=!1}};return(i,e)=>r.value?(p(),I(N,{key:0,onSignupComplete:e[0]||(e[0]=l=>r.value=!1)})):(p(),h("div",_,[e[10]||(e[10]=t("img",{src:U,alt:"로고",class:"logo"},null,-1)),e[11]||(e[11]=t("div",{class:"subtitle"},"돈 걱정 말고, 여행 가자옹!",-1)),t("div",O,[e[4]||(e[4]=t("label",{class:"label"},"이메일",-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.email=l),type:"email",class:"input-box",placeholder:"이메일 입력",disabled:a.value},null,8,P),[[f,o.value.email]]),e[5]||(e[5]=t("label",{class:"label"},"비밀번호",-1)),g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.password=l),type:"password",class:"input-box",placeholder:"비밀번호 입력",disabled:a.value,onKeyup:x(m,["enter"])},null,40,D),[[f,o.value.password]]),t("button",{class:"login-button",disabled:!d.value||a.value,onClick:m},M(a.value?"로그인 중...":"로그인"),9,K)]),t("div",$,[e[6]||(e[6]=t("div",{class:"line left-line"},null,-1)),e[7]||(e[7]=t("div",{class:"or-text"},"또는",-1)),e[8]||(e[8]=t("div",{class:"line right-line"},null,-1)),e[9]||(e[9]=t("div",{class:"no-account-text"},"계정이 없으신가요?",-1)),t("div",{class:"signup-text",onClick:e[3]||(e[3]=l=>L(n).push("/agreement"))},"회원가입")])]))}},W=w(q,[["__scopeId","data-v-b3914bff"]]);export{W as default};
