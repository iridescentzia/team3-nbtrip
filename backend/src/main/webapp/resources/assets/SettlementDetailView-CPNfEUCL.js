import{_ as C,s as T,x as w,q as N,o as R,e as o,f as n,g as t,j as p,y as M,u as s,t as r,F as f,p as h,B as v,C as V}from"./index-JPUeL1pJ.js";import{H as B}from"./Header2-dRI1sboa.js";import{u as I}from"./settlementStore-DCAC_K-Y.js";const L={class:"view-wrapper"},$={class:"settlement-view"},D={key:0,class:"content-container loading"},A={key:1,class:"content-container error"},F={key:2,class:"content-container"},H={class:"summary-header"},j={class:"trip-name"},q={class:"total-amount"},E={class:"settlement-card"},z={class:"transaction-list"},G={key:0},J={class:"member-info"},K={class:"avatar"},O={class:"font-semibold text-sm text-theme-text"},P={class:"amount text-theme-text"},Q={key:1,class:"empty-message text-theme-text"},U={class:"settlement-card"},W={class:"transaction-list"},X={key:0},Y={class:"member-info"},Z={class:"avatar"},tt={class:"font-semibold text-sm"},et={class:"amount"},st={key:1,class:"empty-message"},ot={class:"footer"},nt=["disabled"],at={__name:"SettlementDetailView",setup(lt){const c=I(),{mySettlementData:a,isLoading:y,error:u,showTransferModal:k,totalReceiveAmount:it,totalSendAmount:b,netBalance:rt}=T(c),g=w(),m=N(),d=g.params.tripId;R(async()=>{try{await c.fetchMySettlement(d)}catch{}});const S=()=>{try{c.openTransferModal()}catch(l){alert(l.message)}},_=()=>{c.closeTransferModal()},x=async()=>{c.closeTransferModal();try{const l=await c.executeTransfer();l.failedCount==0?(alert("모든 송금이 완료되었습니다."),m.push(`/settlement/${d}/pending`)):(alert(`송금 실패: ${l.successCount}건 성공, ${l.failedCount}건 실패`),m.push(`/settlement/${d}/failure`))}catch(l){console.error("송금 실패:",l),alert("송금 중 오류가 발생했습니다."),m.push(`/settlement/${d}/failure`)}};return(l,e)=>(n(),o("div",L,[t("div",$,[M(B,{title:"정산하기"}),s(y)?(n(),o("main",D,e[1]||(e[1]=[t("p",null,"내 정산 내역을 불러오는 중...",-1)]))):s(u)?(n(),o("main",A,[t("p",null,r(s(u)),1)])):s(a)?(n(),o("main",F,[t("div",H,[t("p",j,r(s(a).tripName),1),t("h2",q," 총 "+r(s(a).totalAmount?.toLocaleString()||0)+"원 사용 ",1)]),t("div",E,[e[2]||(e[2]=t("p",{class:"card-title text-theme-text"},"받을 돈",-1)),t("div",z,[s(a).toReceive&&s(a).toReceive.length>0?(n(),o("div",G,[(n(!0),o(f,null,h(s(a).toReceive,i=>(n(),o("div",{key:i.settlementId,class:"transaction-item"},[t("div",J,[t("div",K,[t("span",null,r(i.senderNickname?.substring(0,1)||"?"),1)]),t("span",O,r(i.senderNickname||"알 수 없음"),1)]),t("span",P,r(i.amount?.toLocaleString()||0)+"원 ",1)]))),128))])):(n(),o("p",Q," 받을 돈이 없습니다. "))])]),t("div",U,[e[3]||(e[3]=t("p",{class:"card-title"},"보낼 돈",-1)),t("div",W,[s(a).toSend&&s(a).toSend.length>0?(n(),o("div",X,[(n(!0),o(f,null,h(s(a).toSend,i=>(n(),o("div",{key:i.settlementId,class:"transaction-item"},[t("div",Y,[t("div",Z,[t("span",null,r(i.receiverNickname?.substring(0,1)||"?"),1)]),t("span",tt,r(i.receiverNickname||"알 수 없음"),1)]),t("span",et,r(i.amount?.toLocaleString()||0)+"원",1)]))),128))])):(n(),o("p",st,"보낼 돈이 없습니다."))])])])):p("",!0),t("footer",ot,[t("button",{onClick:S,class:"next-button",disabled:s(b)===0}," 송금하기 ",8,nt)])]),s(k)?(n(),o("div",{key:0,class:"modal-overlay",onClick:_},[t("div",{class:"transfer-modal",onClick:e[0]||(e[0]=V(()=>{},["stop"]))},[e[4]||(e[4]=t("div",{class:"modal-icon"},null,-1)),e[5]||(e[5]=t("h3",{class:"modal-title"},"송금하시겠습니까?",-1)),e[6]||(e[6]=t("p",{class:"modal-description"},[v(" 송금 버튼을 누르면 정산이 완료되며,"),t("br"),v(" 되돌릴 수 없습니다. ")],-1)),t("div",{class:"modal-buttons"},[t("button",{onClick:_,class:"modal-cancel-btn"}," 취소 "),t("button",{onClick:x,class:"modal-confirm-btn"}," 확인 ")])])])):p("",!0)]))}},ut=C(at,[["__scopeId","data-v-93b7fddf"]]);export{ut as default};
