import{H as v}from"./Header-BxpBIcx1.js";import{a as f,r as h}from"./settlementApi-CFrT9LOB.js";import{_ as y,r as m,s as g,q as S,o as k,e as a,f as o,g as e,x as b,j as w,t as n,F as x,p as L}from"./index-CQP3BwD-.js";const N={class:"view-wrapper"},V={class:"settlement-view"},T={key:0,class:"content-container loading"},q={key:1,class:"content-container error"},B={key:2,class:"content-container"},I={class:"summary-header"},P={class:"trip-name"},C={class:"total-amount"},D={class:"member-payment-card"},F={class:"member-list"},H={class:"member-info"},R={class:"member-avatar"},$={class:"member-name"},j={class:"member-amount"},A={__name:"SettlementSummaryView",setup(E){const r=m(null),u=m(!0),l=m(null),_=g(),d=S(),c=_.params.tripId;k(async()=>{const s=new Promise(t=>setTimeout(t,800));try{const[t]=await Promise.all([f(c),s]);r.value=t.data}catch(t){console.error("정산 요약 정보 로딩 실패:",t),t.response?.status===403?(l.value="그룹장만 정산을 요청할 수 있습니다.",setTimeout(()=>{d.push(`/trip/${c}`)},3e3)):t.response?.status===404?l.value="여행 정보를 찾을 수 없습니다.":l.value="데이터를 불러오는 데 실패했습니다."}finally{u.value=!1}});const p=async()=>{if(confirm("정산을 생성하시겠습니까?"))try{const s=await h({tripId:c});s.data.success?(alert("정산이 성공적으로 생성되었습니다!"),d.push(`/settlement/${c}/request`)):alert(s.data.message)}catch(s){console.error("정산 생성 실패:",s),alert("정산 생성에 실패했습니다.")}};return(s,t)=>(o(),a("div",N,[e("div",V,[b(v,{title:"정산하기"}),u.value?(o(),a("main",T,t[0]||(t[0]=[e("div",{class:"spinner"},null,-1),e("p",null,"데이터를 불러오는 중...",-1)]))):l.value?(o(),a("main",q,[e("p",null,n(l.value),1)])):r.value?(o(),a("main",B,[e("div",I,[e("p",P,n(r.value.tripName),1),e("h2",C," 총 "+n(r.value.totalAmount?.toLocaleString()||0)+"원 사용 ",1)]),e("div",D,[t[1]||(t[1]=e("h3",{class:"card-title"},"멤버별 결제 내역",-1)),e("div",F,[(o(!0),a(x,null,L(r.value.memberPayments,i=>(o(),a("div",{key:i.nickname,class:"member-item"},[e("div",H,[e("div",R,[e("span",null,n(i.nickname.substring(0,1)),1)]),e("span",$,n(i.nickname),1)]),e("p",j,n(i.amount?.toLocaleString()||0)+"원 ",1)]))),128))])])])):w("",!0),e("footer",{class:"footer"},[e("button",{onClick:p,class:"next-button"},"다음")])])]))}},J=y(A,[["__scopeId","data-v-cc597421"]]);export{J as default};
