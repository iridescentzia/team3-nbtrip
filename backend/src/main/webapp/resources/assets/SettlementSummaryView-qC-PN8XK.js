import{H as h}from"./Header2-UY8uQ6hN.js";import{u as y,g as v,r as S}from"./settlementStore-C9vI0BBV.js";import{_ as g,s as b,a as k,u as w,o as x,c as o,b as n,d as L,g as N,e,f as a,t as r,F as T,h as V}from"./index-C9ApI8vq.js";import"./index-PeG32rCn.js";const B={class:"settlement-view"},I={key:0,class:"content-container loading"},P={key:1,class:"content-container error"},R={key:2,class:"content-container"},q={class:"summary-header"},C={class:"trip-name"},D={class:"total-amount"},F={class:"member-payment-card"},H={class:"member-list"},$={class:"member-info"},A={class:"member-avatar"},E={class:"member-name"},M={class:"member-amount"},j={__name:"SettlementSummaryView",setup(z){const _=y(),{summaryData:i,isLoading:u,error:c}=b(_),p=k(),d=w(),l=p.params.tripId;x(async()=>{const s=new Promise(t=>setTimeout(t,800));try{const[t]=await Promise.all([v(l),s]);i.value=t.data}catch(t){console.error("정산 요약 정보 로딩 실패:",t),t.response?.status===403?(c.value="그룹장만 정산을 요청할 수 있습니다.",setTimeout(()=>{d.push(`/trip/${l}`)},3e3)):t.response?.status===404?c.value="여행 정보를 찾을 수 없습니다.":c.value="데이터를 불러오는 데 실패했습니다."}finally{u.value=!1}});const f=async()=>{if(confirm("정산을 생성하시겠습니까?"))try{const s=await S({tripId:l});s.data.success?(alert("정산이 성공적으로 생성되었습니다!"),d.push(`/settlement/${l}/request`)):alert(s.data.message)}catch(s){console.error("정산 생성 실패:",s),alert("정산 생성에 실패했습니다.")}};return(s,t)=>(n(),o("div",B,[L(h,{title:"정산하기"}),a(u)?(n(),o("main",I,t[0]||(t[0]=[e("div",{class:"spinner"},null,-1),e("p",null,"데이터를 불러오는 중...",-1)]))):a(c)?(n(),o("main",P,[e("p",null,r(a(c)),1)])):a(i)?(n(),o("main",R,[e("div",q,[e("p",C,r(a(i).tripName),1),e("h2",D," 총 "+r(a(i).totalAmount?.toLocaleString()||0)+"원 사용 ",1)]),e("div",F,[t[1]||(t[1]=e("h3",{class:"card-title"},"멤버별 결제 내역",-1)),e("div",H,[(n(!0),o(T,null,V(a(i).memberPayments,m=>(n(),o("div",{key:m.nickname,class:"member-item"},[e("div",$,[e("div",A,[e("span",null,r(m.nickname.substring(0,1)||"?"),1)]),e("span",E,r(m.nickname),1)]),e("p",M,r(m.amount?.toLocaleString()||0)+"원 ",1)]))),128))])])])):N("",!0),e("footer",{class:"footer"},[e("button",{onClick:f,class:"next-button"},"다음")])]))}},Q=g(j,[["__scopeId","data-v-2b3556c8"]]);export{Q as default};
