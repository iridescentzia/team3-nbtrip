import{H as S}from"./Header-xfQMi4Q3.js";import{b,t as x}from"./settlementApi-D4YvClna.js";import{_ as R,r as m,s as I,q as N,o as w,c as _,e as a,f as o,g as e,x as L,j as $,t as r,F as p,p as h}from"./index-Kd1lVUqJ.js";const C={class:"view-wrapper"},D={class:"settlement-view"},V={key:0,class:"content-container loading"},A={key:1,class:"content-container error"},B={key:2,class:"content-container"},M={class:"summary-header"},F={class:"trip-name"},H={class:"total-amount"},T={class:"settlement-card"},j={class:"transaction-list"},q={key:0},E={class:"member-info"},z={class:"avatar"},G={class:"font-semibold text-sm text-theme-text"},J={class:"amount text-theme-text"},K={key:1,class:"empty-message text-theme-text"},O={class:"settlement-card"},P={class:"transaction-list"},Q={key:0},U={class:"member-info"},W={class:"avatar"},X={class:"font-semibold text-sm"},Y={class:"amount"},Z={key:1,class:"empty-message"},ee={class:"footer"},te=["disabled"],se={__name:"SettlementDetailView",setup(ne){const t=m(null),v=m(!0),d=m(null),f=I(),u=N(),i=f.params.tripId;w(async()=>{try{const n=await b(i);t.value=n.data}catch(n){console.error("ê°œì¸ ì •ì‚° ì •ë³´ ë¡œë”© ì‹¤íŒ¨:",n),d.value="ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."}finally{v.value=!1}});const y=_(()=>t.value?.toReceive?t.value.toReceive.reduce((n,l)=>n+l.amount,0):0),c=_(()=>t.value?.toSend?t.value.toSend.reduce((n,l)=>n+l.amount,0):0);_(()=>y.value-c.value);const g=async()=>{if(c.value===0){alert("ë³´ë‚¼ ëˆì´ ì—†ìŠµë‹ˆë‹¤.");return}if(confirm(`ì´ ${c.value.toLocaleString()}ì›ì„ ì†¡ê¸ˆí• ê¹Œìš”?`))try{const n=t.value.toSend.map(k=>k.settlementId),s=(await x({settlementIds:n})).data;s.failedCount==0?(alert("ëª¨ë“  ì†¡ê¸ˆì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."),u.push(`/settlement/${i}/pending`)):(alert(`ì†¡ê¸ˆ ì‹¤íŒ¨: ${s.successCount}ê±´ ì„±ê³µ, ${s.failedCount}ê±´ ì‹¤íŒ¨`),u.push(`/settlement/${i}/failure`))}catch(n){console.error("ì†¡ê¸ˆ ì‹¤íŒ¨:",n),alert("ì†¡ê¸ˆ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),u.push(`/settlement/${i}/failure`)}};return(n,l)=>(o(),a("div",C,[e("div",D,[L(S,{title:"ì •ì‚°í•˜ê¸°"}),v.value?(o(),a("main",V,l[0]||(l[0]=[e("p",null,"ë‚´ ì •ì‚° ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",-1)]))):d.value?(o(),a("main",A,[e("p",null,r(d.value),1)])):t.value?(o(),a("main",B,[e("div",M,[e("p",F,r(t.value.tripName),1),e("h2",H," ì´ "+r(t.value.totalAmount?.toLocaleString()||0)+"ì› ì‚¬ìš© ",1)]),e("div",T,[l[1]||(l[1]=e("p",{class:"card-title text-theme-text"},"ğŸ’¸ ë°›ì„ ëˆ",-1)),e("div",j,[t.value.toReceive&&t.value.toReceive.length>0?(o(),a("div",q,[(o(!0),a(p,null,h(t.value.toReceive,s=>(o(),a("div",{key:s.settlementId,class:"transaction-item"},[e("div",E,[e("div",z,[e("span",null,r(s.senderNickname.substring(0,1)),1)]),e("span",G,r(s.senderNickname),1)]),e("span",J,r(s.amount.toLocaleString())+"ì›",1)]))),128))])):(o(),a("p",K," ë°›ì„ ëˆì´ ì—†ìŠµë‹ˆë‹¤. "))])]),e("div",O,[l[2]||(l[2]=e("p",{class:"card-title"},"ğŸ’Œ ë³´ë‚¼ ëˆ",-1)),e("div",P,[t.value.toSend&&t.value.toSend.length>0?(o(),a("div",Q,[(o(!0),a(p,null,h(t.value.toSend,s=>(o(),a("div",{key:s.settlementId,class:"transaction-item"},[e("div",U,[e("div",W,[e("span",null,r(s.receiverNickname.substring(0,1)),1)]),e("span",X,r(s.receiverNickname),1)]),e("span",Y,r(s.amount.toLocaleString())+"ì›",1)]))),128))])):(o(),a("p",Z,"ë³´ë‚¼ ëˆì´ ì—†ìŠµë‹ˆë‹¤."))])])])):$("",!0),e("footer",ee,[e("button",{onClick:g,class:"next-button",disabled:c.value===0}," ì†¡ê¸ˆí•˜ê¸° ",8,te)])])]))}},re=R(se,[["__scopeId","data-v-21ffbabf"]]);export{re as default};
